# 安全测试通用检查单 (Security Test Checklist)

## 1. 身份认证与授权 (Authentication & Authorization)
- [ ] **强密码策略**: 验证是否强制要求密码长度（如8位+）、复杂度（大小写+数字+符号）。
- [ ] **多因素认证 (MFA)**: 关键操作或敏感账户是否支持 MFA。
- [ ] **暴力破解防护**: 验证是否有账户锁定机制、验证码或渐进式延时。
- [ ] **水平越权 (IDOR)**: 用户 A 修改 ID 参数后，是否能访问用户 B 的数据。
- [ ] **垂直越权**: 普通用户是否能访问管理员接口（如 `/admin/*`）。
- [ ] **Session 管理**: 退出登录后 Session 是否立即失效；Session 超时机制是否生效。

## 2. 输入验证 (Input Validation)
- [ ] **SQL 注入**: 在输入框或 URL 参数中尝试 `' OR '1'='1` 等 Payload。
- [ ] **XSS 跨站脚本**: 尝试输入 `<script>alert(1)</script>`，查看是否被转义或执行。
- [ ] **文件上传**: 验证是否限制文件类型（白名单）、文件大小；是否能上传 `.php`, `.jsp`, `.exe` 等可执行文件。
- [ ] **XML 实体注入 (XXE)**: 如果接口接收 XML，尝试注入外部实体引用。

## 3. 数据安全 (Data Security)
- [ ] **敏感数据脱敏**: 手机号、身份证号、银行卡号在前端展示时是否进行掩码处理（如 `138****1234`）。
- [ ] **传输加密**: 所有敏感数据传输必须使用 HTTPS；检查 SSL/TLS 版本是否安全（禁用 SSLv3, TLS 1.0）。
- [ ] **日志安全**: 检查系统日志中是否记录了明文密码、Token 或支付信息。
- [ ] **缓存控制**: 敏感页面是否设置了 `Cache-Control: no-store`。

## 4. 安全配置 (Security Configuration)
- [ ] **安全响应头**: 检查 HSTS, CSP, X-Frame-Options, X-XSS-Protection。
- [ ] **错误信息**: 报错页面是否泄露了堆栈信息、数据库版本或服务器路径。
- [ ] **目录遍历**: 尝试访问 `../../etc/passwd` 或类似路径，验证是否能访问系统文件。
- [ ] **默认凭证**: 验证后台、数据库、中间件是否使用了默认账号密码（如 `admin/admin`）。

## 5. 业务逻辑安全 (Business Logic)
- [ ] **支付漏洞**: 尝试修改金额为负数、0 或超大数值；尝试修改商品单价。
- [ ] **并发安全**: 尝试并发请求领取优惠券、提现或转账，验证是否有竞态条件漏洞。
- [ ] **验证码绕过**: 验证码是否可重复使用；是否可被暴力破解；是否在响应中直接返回了验证码。
